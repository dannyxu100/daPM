iChart.Line=iChart.extend(iChart.Chart,{configure:function(){iChart.Line.superclass.configure.call(this);this.type="line";this.set({brushsize:1,coordinate:{axis:{width:[0,0,2,2]}},crosshair:{enable:!1},tipMocker:null,tipMockerOffset:null,scaleAlign:"left",labelAlign:"bottom",labels:[],label_space:6,proportional_spacing:!0,point_space:null,sub_option:{},legend:{sign:"bar"},label:{}});this.registerEvent("parsePoint")},getCoordinate:function(){return this.coo},doConfig:function(){iChart.Line.superclass.doConfig.call(this);var a=this._(),c=1==a.data.length;a.lines=[];a.lines.zIndex=a.get("z_index");a.components.push(a.lines);var n=a.pushIf("sub_option.keep_with_coordinate",c);a.get("crosshair.enable")&&(a.push("crosshair.hcross",c),a.push("crosshair.invokeOffset",function(b){b=a.lines[0].isEventValid(b);return b.valid?b:n}));a.Combination||(a.push("coordinate.crosshair",a.get("crosshair")),a.pushIf("coordinate.scale",[{position:a.get("scaleAlign"),max_scale:a.get("maxValue")},{position:a.get("labelAlign"),start_scale:1,scale:1,end_scale:a.get("maxItemSize"),labels:a.get("labels"),label:a.get("label")}]));a.coo=iChart.Coordinate.coordinate_.call(a);a.Combination&&(a.coo.push("crosshair",a.get("crosshair")),a.coo.doCrosshair(a.coo));var c=a.coo.get("valid_width"),o=a.coo.get("valid_height"),k=c/(a.get("maxItemSize")-1),g=a.get("point_space");a.get("proportional_spacing")&&(g&&g<k?c=(a.get("maxItemSize")-1)*g:a.push("point_space",k));a.push("sub_option.width",c);a.push("sub_option.height",o);a.push("sub_option.originx",a.coo.get("x_start")+(a.coo.get("valid_width")-c)/2);a.push("sub_option.originy",a.coo.get(a.Y)+a.coo.get(a.H));if(a.get("tip.enable")&&iChart.isFunction(a.get("tipMocker"))){a.push("sub_option.tip.enable",!1);a.push("tip.invokeOffsetDynamic",!0);var h,p=a.coo.get(a.X),i=a.coo.get(a.Y),l=a.coo.get(a.H),f=a.get("tipMockerOffset"),m,b,e,f=iChart.isNumber(f)?0>f?0:1<f?1:f:null;a.push("tip.invokeOffset",function(a,b,d){if(f!=null)d.top=i+(l-b)*f;else{d.top=d.maxTop-(d.maxTop-d.minTop)/3-b;if(b>l||i>d.top)d.top=i}return{left:d.left-a-p>5?d.left-a-5:d.left+5,top:d.top}});var j=a.get("tip.listeners.parseText");j&&delete a.get("tip.listeners").parseText;c=new iChart.Custom({eventValid:function(c){b=a.lines[0].isEventValid(c);b.hit=m!=b.i;if(b.valid){m=b.i;h=[];a.lines.each(function(a,d){e=a.isEventValid(c);if(d==0)b.minTop=b.maxTop=e.top;else{b.minTop=Math.min(b.minTop,e.top);b.maxTop=Math.max(b.maxTop,e.top)}h.push(j?j(null,e.name,e.value,e.text,e.i):e.name+" "+e.value)});b.text=a.get("tipMocker").call(a,h,b.i)||"tipMocker not return"}return b.valid?b:false}});new iChart.Tip(a.get("tip"),c);a.components.push(c)}iChart.applyIf(a.get("sub_option"),iChart.clone(["area_opacity"],a.options))}});
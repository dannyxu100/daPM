(function(b){b.Rectangle=b.extend(b.Component,{configure:function(){b.Rectangle.superclass.configure.apply(this,arguments);this.type="rectangle";this.set({width:0,height:0,value_space:4,value:"",label:{},name:"",tipAlign:"top",valueAlign:"top",shadow_blur:3,shadow_offsety:-1});this.atomic=!0;this.registerEvent("parseText");this.label=null},doDraw:function(a){a.drawRectangle();a.label&&a.label.draw()},doConfig:function(){b.Rectangle.superclass.doConfig.call(this);var a=this._(),d=a.variable.event,c=a.get("valueAlign");b.taylor.light(a,d);a.width=a.get(a.W);a.height=a.get(a.H);var d=a.push("centerx",a.x+a.width/2),e=a.push("centery",a.y+a.height/2),g=a.C,f="middle",h=a.get("value_space");a.push("value",a.fireString(a,"parseText",[a,a.get("value")],a.get("value")));c==a.L?(g=a.R,d=a.x-h):c==a.R?(g=a.L,d=a.x+a.width+h):c==a.B?(e=a.y+a.height+h,f=a.O):c==a.O&&(e=a.y-h,f=a.B);a.get("label")&&(a.push("label.originx",d),a.push("label.originy",e),a.push("label.text",a.get("value")),b.applyIf(a.get("label"),{textAlign:g,textBaseline:f,color:a.get("color")}),a.label=new b.Text(a.get("label"),a));a.get("tip.enable")&&("follow"!=a.get("tip.showType")&&a.push("tip.invokeOffsetDynamic",!1),a.tip=new b.Tip(a.get("tip"),a))}});b.Rectangle2D=b.extend(b.Rectangle,{configure:function(){b.Rectangle2D.superclass.configure.apply(this,arguments);this.type="rectangle2d";this.set({shadow_offsety:-2})},drawRectangle:function(){var a=this._();a.T.box(a.get(a.X),a.get(a.Y),a.get(a.W),a.get(a.H),a.get("border"),a.get("f_color"),a.get("shadow"))},isEventValid:function(a,b){return{valid:a.x>b.x&&a.x<b.x+b.width&&a.y<b.y+b.height&&a.y>b.y}},tipInvoke:function(){var a=this._();return function(b,c){return{left:a.tipX(b,c),top:a.tipY(b,c)}}},doConfig:function(){b.Rectangle2D.superclass.doConfig.call(this);var a=this._(),d=a.get("tipAlign");d==a.L||d==a.R?a.tipY=function(b,d){return a.get("centery")-d/2}:a.tipX=function(b){return a.get("centerx")-b/2};d==a.L?a.tipX=function(b){return a.x-a.get("value_space")-b}:d==a.R?a.tipX=function(){return a.x+a.width+a.get("value_space")}:a.tipY=d==a.B?function(){return a.y+a.height+3}:function(b,d){return a.y-d-3};a.applyGradient()}});b.Rectangle3D=b.extend(b.Rectangle,{configure:function(){b.Rectangle3D.superclass.configure.apply(this,arguments);this.type="rectangle3d";this.dimension=b._3D;this.set({zHeight:void 0,xAngle:60,yAngle:20,xAngle_:void 0,yAngle_:void 0,shadow_offsetx:2})},drawRectangle:function(){var a=this._();a.T.cube(a.get(a.X),a.get(a.Y),a.get("xAngle_"),a.get("yAngle_"),a.get(a.W),a.get(a.H),a.get("zHeight"),a.get("f_color"),a.get("border.enable"),a.get("border.width"),a.get("light_color"),a.get("shadow"))},isEventValid:function(a,b){return{valid:a.x>b.x&&a.x<b.x+b.get(b.W)&&a.y<b.y+b.get(b.H)&&a.y>b.y}},tipInvoke:function(){var a=this._();return function(b,c){return{left:a.topCenterX-b/2,top:a.topCenterY-c}}},doConfig:function(){b.Rectangle3D.superclass.doConfig.call(this);var a=this._();a.pushIf("zHeight",a.get(a.W));a.topCenterX=a.x+(a.get(a.W)+a.get(a.W)*a.get("xAngle_"))/2;a.topCenterY=a.y-a.get(a.W)*a.get("yAngle_")/2;a.get("valueAlign")==a.O&&a.label&&(a.label.push("textx",a.topCenterX),a.label.push("texty",a.topCenterY))}});b.Column=b.extend(b.Chart,{configure:function(){b.Column.superclass.configure.call(this);this.type="column";this.set({coordinate:{},column_width:void 0,column_space:void 0,text_space:6,scaleAlign:"left",sub_option:{},label:{}});this.registerEvent()},doAnimation:function(a,b,c){var e;c.labels.each(function(a){a.draw()});c.rectangles.each(function(g){e=Math.ceil(c.animationArithmetic(a,0,g.height,b));g.push(c.Y,g.y+(g.height-e));g.push(c.H,e);g.drawRectangle()})},getCoordinate:function(){return this.coo},doLabel:function(a,d,c,e,g){a.labels.push(new b.Text(b.apply(a.get("label"),{id:d,text:c,originx:e,originy:g}),a))},doParse:function(a,b,c,e){a.doActing(a,b,e,c)},engine:function(a){var b=a.get("column_width"),c=a.get("column_space"),e=a.coo.getScale(a.get("scaleAlign")),g=a.coo.get(a.H),f=b/2,h=b*(a.get("group_fator")||0),k="complex"!=a.dataType?b+c:a.data.length*b+c+(a.is3D()?(a.data.length-1)*h:0),i=a.coo.get(a.Y)+g,l=i-e.basic*g-(a.is3D()?a.get("zHeight")*(a.get("bottom_scale")-1)/2*a.get("yAngle_"):0),j=c+a.coo.get("x_start"),i=i+a.get("text_space")+a.coo.get("axis.width")[2];a.doEngine(a,b,c,e,g,f,h,k,j,l,i)},doConfig:function(){b.Column.superclass.doConfig.call(this);var a=this._();a.sub=a.is3D()?"Rectangle3D":"Rectangle2D";a.rectangles=[];a.labels=[];a.components.push(a.labels);a.components.push(a.rectangles);a.coo=b.Coordinate.coordinate_.call(a,function(){var b=a.data.length,c=a.get("coordinate.valid_width"),e,g,f;"complex"==a.dataType?(f=a.get("labels").length,b=f*b+(a.is3D()?(b-1)*f*a.get("group_fator"):0),e=Math.floor(c/(f+1+b)),g=a.pushIf("column_width",e),f+=1):("stacked"==a.dataType&&(b=a.get("labels").length),e=Math.floor(2*c/(3*b+1)),g=a.pushIf("column_width",e),f=b+1);g*b>c&&(g=a.push("column_width",e));a.push("column_space",(c-g*b)/f);a.is3D()&&(a.push("zHeight",a.get("column_width")*a.get("zScale")),a.push("sub_option.zHeight",a.get("zHeight")),a.push("sub_option.xAngle_",a.get("xAngle_")),a.push("sub_option.yAngle_",a.get("yAngle_")))});a.rectangles.zIndex=a.get("z_index");a.labels.zIndex=a.get("z_index")+1;a.push("sub_option.width",a.get("column_width"))}});b.Column2D=b.extend(b.Column,{configure:function(){b.Column2D.superclass.configure.call(this);this.type="column2d"},doEngine:function(a,d,c,e,g,f,h,k,i,l,j){var m;a.data.each(function(c,d){m=(c.value-e.start)*g/e.distance;a.doParse(a,c,d,{id:d,originx:i+d*k,originy:l-(0<m?m:0),height:Math.abs(m)});a.rectangles.push(new b[a.sub](a.get("sub_option"),a));a.doLabel(a,d,c.name,i+k*d+f,j)},a)},doConfig:function(){b.Column2D.superclass.doConfig.call(this);this.engine(this)}});b.Column3D=b.extend(b.Column2D,{configure:function(){b.Column3D.superclass.configure.call(this);this.type="column3d";this.dimension=b._3D;this.set({coordinate:{},xAngle:60,yAngle:20,zScale:1,bottom_scale:1.4})},doConfig:function(){b.Column3D.superclass.doConfig.call(this)}});b.ColumnStacked2D=b.extend(b.Column,{configure:function(){b.ColumnStacked2D.superclass.configure.call(this);this.type="columnstacked2d";this.dataType="stacked";this.set({percent:!1,sub_option:{label:{color:"#ffffff"},valueAlign:"middle"}})},doEngine:function(a,d,c,e,g,f,h,k,i,l,j){var m,n,o,p=a.get("percent");a.columns.each(function(d,f){m=0;o=p?100/d.total:1;d.item.each(function(c,h){n=(c.value*o-e.start)*g/e.distance;c.total=d.total;a.doParse(a,c,h,{id:f+"_"+h,originx:i+f*k,originy:l-(0<n?n:0)-m,height:Math.abs(n)});m+=n;a.rectangles.push(new b[a.sub](a.get("sub_option"),a))},a);a.doLabel(a,f,d.name,i-0.5*c+(f+0.5)*k,j)},a)},doConfig:function(){b.ColumnStacked2D.superclass.doConfig.call(this);this.engine(this)}});b.ColumnStacked3D=b.extend(b.ColumnStacked2D,{configure:function(){b.ColumnStacked3D.superclass.configure.call(this);this.type="columnstacked3d";this.dataType="stacked";this.dimension=b._3D;this.set({percent:!1,sub_option:{label:{color:"#ffffff"},valueAlign:"middle"},coordinate:{},xAngle:60,yAngle:20,zScale:1,bottom_scale:1.4})},doConfig:function(){b.ColumnStacked3D.superclass.doConfig.call(this)}});b.ColumnMulti2D=b.extend(b.Column,{configure:function(){b.ColumnMulti2D.superclass.configure.call(this);this.type="columnmulti2d";this.dataType="complex";this.set({labels:[]})},doEngine:function(a,d,c,e,g,f,h,k,i,l,j){var m;a.columns.each(function(f,o){f.item.each(function(c,f){m=(c.value-e.start)*g/e.distance;a.doParse(a,c,f,{id:o+"_"+f,originx:i+f*(d+h)+o*k,originy:l-(0<m?m:0),height:Math.abs(m)});a.rectangles.push(new b[a.sub](a.get("sub_option"),a))},a);a.doLabel(a,o,f.name,i-0.5*c+(o+0.5)*k,j)},a)},doConfig:function(){b.ColumnMulti2D.superclass.doConfig.call(this);this.engine(this)}});b.ColumnMulti3D=b.extend(b.ColumnMulti2D,{configure:function(){b.ColumnMulti3D.superclass.configure.call(this);this.type="columnmulti3d";this.dataType="complex";this.dimension=b._3D;this.set({xAngle:60,yAngle:20,zScale:1,group_fator:0.3,bottom_scale:1.4})},doConfig:function(){b.ColumnMulti3D.superclass.doConfig.call(this)}});b.Bar=b.extend(b.Chart,{configure:function(){b.Bar.superclass.configure.call(this);this.type="bar";this.set({coordinate:{striped_direction:"h"},bar_height:void 0,bar_space:void 0,text_space:6,scaleAlign:"bottom",sub_option:{},label:{}})},getCoordinate:function(){return this.coo},doLabel:function(a,d,c,e){this.labels.push(new b.Text(b.apply(this.get("label"),{id:a,text:d,textAlign:"right",textBaseline:"middle",originx:c,originy:e}),this))},doParse:function(a,b,c,e){a.doActing(a,b,e,c)},engine:function(a){var b=a.get("bar_height"),c=a.get("bar_space"),e=a.coo.getScale(a.get("scaleAlign")),g=a.coo.get(a.W),f=b/2,h="complex"!=a.dataType?b+c:a.data.length*b+c,k=a.coo.get(a.X)+e.basic*g,i=a.coo.get(a.X)-a.get("text_space")-a.coo.get("axis.width")[3],l=a.coo.get("y_start")+c;a.doEngine(a,b,c,e,g,f,h,k,i,l)},doAnimation:function(a,b,c){c.labels.each(function(a){a.draw()});c.rectangles.each(function(e){e.push(c.W,Math.ceil(c.animationArithmetic(a,0,e.width,b)));e.drawRectangle()})},doConfig:function(){b.Bar.superclass.doConfig.call(this);var a=this._();a.coo=b.Coordinate.coordinate_.call(a);a.rectangles=[];a.labels=[];a.rectangles.zIndex=a.get("z_index");a.labels.zIndex=a.get("z_index")+1;a.components.push(a.labels);a.components.push(a.rectangles);var d=a.data.length,c=a.coo.get("valid_height"),e,g,f;"simple"==a.dataType?(e=Math.floor(2*c/(3*d+1)),g=a.pushIf("bar_height",e),f=d+1):(f=a.get("labels").length,d=f*d+(a.is3D()?(d-1)*f*a.get("group_fator"):0),e=Math.floor(c/(f+1+d)),g=a.pushIf("bar_height",e),f+=1);g*d>c&&(g=a.push("bar_height",e));a.push("bar_space",(c-g*d)/f);a.push("sub_option.height",g);a.push("sub_option.valueAlign",a.R);a.push("sub_option.tipAlign",a.R)}});b.Bar2D=b.extend(b.Bar,{configure:function(){b.Bar2D.superclass.configure.call(this);this.type="bar2d"},doEngine:function(a,d,c,e,g,f,h,k,i,l){var j;a.data.each(function(c,d){j=(c.value-e.start)*g/e.distance;a.doParse(a,c,d,{id:d,originy:l+d*h,width:Math.abs(j),originx:k+(0<j?0:-Math.abs(j))});a.rectangles.push(new b.Rectangle2D(a.get("sub_option"),a));a.doLabel(d,c.name,i,l+d*h+f)},a)},doConfig:function(){b.Bar2D.superclass.doConfig.call(this);this.engine(this)}});b.BarMulti2D=b.extend(b.Bar,{configure:function(){b.BarMulti2D.superclass.configure.call(this);this.type="barmulti2d";this.dataType="complex";this.set({labels:[]})},doEngine:function(a,d,c,e,g,f,h,k,i,l){var j;a.columns.each(function(f,n){f.item.each(function(c,f){j=(c.value-e.start)*g/e.distance;a.doParse(a,c,f,{id:n+"_"+f,originy:l+f*d+n*h,width:Math.abs(j),originx:k+(0<j?0:-Math.abs(j))});a.rectangles.push(new b.Rectangle2D(a.get("sub_option"),a))},a);a.doLabel(n,f.name,i,l-0.5*c+(n+0.5)*h)},a)},doConfig:function(){b.BarMulti2D.superclass.doConfig.call(this);this.engine(this)}})})(iChart);